
# ğŸ“– Overview
<!-- ì¬í™œìš© í’ˆëª© ë¶„ë¥˜ë¥¼ ìœ„í•œ Object Detection -->
ë³¸ í”„ë¡œì íŠ¸ëŠ” í˜„ëŒ€ ì‚¬íšŒì˜ ì“°ë ˆê¸° ì²˜ë¦¬ ë¬¸ì œì™€ í™˜ê²½ ìœ„ê¸°ì— ëŒ€ì‘í•˜ê¸° ìœ„í•´ 2ì°¨ì› ì´ë¯¸ì§€ ê¸°ë°˜ì˜ ì“°ë ˆê¸° ë¶„ë¥˜ ëª¨ë¸ì„ ê°œë°œì„ ëª©í‘œë¡œ í•¨. EDAë¥¼ í†µí•´ ë°ì´í„° í’ˆì§ˆ ë° í´ë˜ìŠ¤ ê°„ ë¶ˆê· í˜• ë¬¸ì œë¥¼ íŒŒì•…í•¨. ì´ë¥¼ í•´ê²°í•˜ê³ ì ì „ëµì  í•™ìŠµ ë°ì´í„° ë¶„ë¥˜, ë°ì´í„° ì •ì œ, ë°ì´í„° ì¦ê°•, ì´ˆí•´ìƒë„, ë””ë¸”ëŸ¬ë§, í´ë˜ìŠ¤ ì¬ë¶„ë¥˜, ë‹¤ì–‘í•œ ëª¨ë¸ í•™ìŠµ ë° ì•™ìƒë¸” ë“±ì˜ ì „ëµ ìˆ˜ë¦½ í›„ ê° ì‹¤í—˜ì„ íƒìƒ‰ì ìœ¼ë¡œ ìˆ˜í–‰ í›„ ê° ì „ëµì— ëŒ€í•œ ê²°ê³¼ë¥¼ ë¹„êµ ë¶„ì„í•¨. ì´ ì¤‘ ê°€ì¥ ìœ ì˜ë¯¸í•œ ê²°ê³¼ë¥¼ ì–»ì€ ì „ëµì„ ìµœì¢…ì ìœ¼ë¡œ ì ìš©í•˜ì—¬ ìµœì¢… 2ìœ„ì˜ ì„±ì ì„ ê±°ë‘ .

## ğŸ† Rank

<center>
<img src="https://github.com/Eddie-JUB/Portfolio/assets/71426994/76025384-e009-42a3-99cf-46d263b94319" width="700" height="">
<div align="center">
  <sup>Test dataset(Public)
</sup>
</div>
</center>

<center>
<img src="https://github.com/Eddie-JUB/Portfolio/assets/71426994/578db702-6361-4262-bfe1-25e3c9e8aba7" width="700" height="">
<div align="center">
  <sup>Test dataset(Private)
</sup>
</div>
</center>


## ğŸ—‚ Dataset


<center>
<img src="https://github.com/Eddie-JUB/Portfolio/assets/71426994/474d0b88-6d5b-43b3-84df-b18b858a17ad" width="700" height="">
<div align="center">
  <sup>Example image data w/ 2D Bounding Boxes, annotation data
</sup>
</div>
</center>



- **Images & Size :**   (Train), 4871 (Test), (1024, 1024)
- **classes :** General trash, Paper, Paper pack, Metal, Glass, Plastic, Styrofoam, Plastic bag, Battery, Clothing
<!-- - **Annotations :** Image size, class,  -->

<!-- <br/> -->
# Team CV-01

## ğŸ‘¬ğŸ¼ Members 
<table>
    <tr height="160px">
        <td align="center" width="150px">
            <a href="https://github.com/minyun-e"><img height="110px"  src="https://github.com/Eddie-JUB/Portfolio/assets/71426994/6ac5b0db-2f18-4e80-a571-77c0812c0bdc"></a>
            <br/>
            <a href="https://github.com/minyun-e"><strong>ê¹€ë¯¼ìœ¤</strong></a>
            <br />
        </td>
        <td align="center" width="150px">
            <a href="https://github.com/2018007956"><img height="110px"  src="https://github.com/Eddie-JUB/Portfolio/assets/71426994/cabba669-dda2-4ead-9f73-00128c0ae175"/></a>
            <br/>
            <a href="https://github.com/2018007956"><strong>ê¹€ì±„ì•„</strong></a>
            <br />
        </td>
        <td align="center" width="150px">
            <a href="https://github.com/Eddie-JUB"><img height="110px"  src="https://github.com/Eddie-JUB/Portfolio/assets/71426994/2829c82d-ecc8-49fd-9cb3-ae642fbe7513"/></a>
            <br/>
            <a href="https://github.com/Eddie-JUB"><strong>ë°°ì¢…ìš±</strong></a>
            <br />
        </td>
        <td align="center" width="150px">
            <a href="https://github.com/FinalCold"><img height="110px" src="https://github.com/Eddie-JUB/Portfolio/assets/71426994/fdeb0582-a6f1-4d70-9d08-dc2f9639d7a5"/></a>
            <br />
            <a href="https://github.com/FinalCold"><strong>ë°•ì°¬ì¢…</strong></a>
            <br />
        </td>
        <td align="center" width="150px">
            <a href="https://github.com/MalMyeong"><img height="110px" src="https://github.com/Eddie-JUB/Portfolio/assets/71426994/0583f648-d097-44d9-9f05-58102434f42d"/></a>
            <br />
            <a href="https://github.com/MalMyeong"><strong>ì¡°ëª…í˜„</strong></a>
            <br />
        </td>
        <td align="center" width="150px">
              <a href="https://github.com/classaen7"><img height="110px"  src="https://github.com/Eddie-JUB/Portfolio/assets/71426994/2806abc1-5913-4906-b44b-d8b92d7c5aa5"/></a>
              <br />
              <a href="https://github.com/classaen7"><strong>ìµœì‹œí˜„</strong></a>
              <br />
          </td>
    </tr>
</table>  
      
                

## ğŸ‘©â€ğŸ’» Roles

|Name|Roles|
|:-------:|:--------------------------------------------------------------:|
|Common| EDA, Data Relabeling, SGK-Fold, ëª¨ë¸ í•™ìŠµ, ì•„ì´ë””ì–´ ê²€ì¦         |
|ê¹€ë¯¼ìœ¤| MMDetection ëª¨ë¸ baseline ì‘ì„±, ëª¨ë¸ ì‹¤í—˜ ë° í‰ê°€|
|ê¹€ì±„ì•„| Deblurring, Super Resolution|
|ë°°ì¢…ìš±| í”„ë¡œì íŠ¸ ê¸°íš, General class reclassifcation, Super Resolution |
|ë°•ì°¬ì¢…| Framework ë³„ Baseline ì‘ì„±, RandAugment ì‹¤í—˜, ëª¨ë¸ ì‹¤í—˜ ë° í‰ê°€|
|ì¡°ëª…í˜„| wandb ì„¸íŒ…, General trash class reclassification |
|ìµœì‹œí˜„| MMDetection ëª¨ë¸ ì‹¤í—˜, Augmentation ì‹¤í—˜, Ensemble ì‹¤í—˜|


</br>

## ğŸ’» Enviroments

- Language: Python 3.10
- Hardwares: Intel(R) Xeon(R) Gold 5120, Tesla V100-SXM2 32GB Ã— 6
- Framework: Pytorch, Detectron2 v0.6, Ultralytics v8.1, MMDetection v3.3.0
- Cowork Tools: Github, Weight and Bias, Notion, Discord, Zoom, Google calendar
- Labeling Tool: Supervisely

</br>

# ğŸ“Š Project
## ğŸ” EDA

<!-- <center>
<img src="https://github.com/Eddie-JUB/Portfolio/assets/71426994/4dd0e517-83dc-4d7e-9c3f-c6d7db10ed7c" width="700" height="">
</center> -->


> ### Class Imbalance, Object Size

<center>
<img src="https://github.com/Eddie-JUB/Portfolio/assets/71426994/80ffd163-697a-4326-b77b-12761df7ca20" width="900" height="">
<div align="center">
  <sup>Distribution of Bbox area as % of Image area by class
</sup>
</div>
</center>


- ì „ì²´ ë°ì´í„°ì—ì„œ Paper, Plastic bag, General trashê°€ ë†’ì€ ë¹„ìœ¨ì„ ì°¨ì§€í•˜ê³  ìˆìœ¼ë©° ë°ì´í„°ì˜ ë¶„í¬ê°€ ë¶ˆê· í˜•ì„ ì´ë£¸
- ê° í´ë˜ìŠ¤ ë³„ ê°ì²´ì˜ í¬ê¸° ë¶„í¬ëŠ” ì‘ì€ ìˆœìœ¼ë¡œ í° ê°ì²´ë¡œ ê°ˆ ìˆ˜ë¡ ì¤„ì–´ë“¦

</br>

> ### Object Position

<center>
<img src="https://github.com/Eddie-JUB/Portfolio/assets/71426994/bd57a124-f7d8-45e8-9d29-afcb58e97daa" width="600" height="200">
<div align="center">
  <sup>Object Bounding Box distribution of each class
</sup>
</div>
</center>


- ì´ë¯¸ì§€ ìƒì˜ ê°ì²´ë“¤ì´ ì´ë¯¸ì§€ì˜ ì¤‘ì‹¬ë¶€ì— ì£¼ë¡œ ìœ„ì¹˜í•˜ê³  ìˆìŒ
</br>

## ğŸ”— Pipeline
<center>
<img src="https://github.com/Eddie-JUB/Portfolio/assets/71426994/ab4035dc-ed98-435f-997c-4dc0cce31955" >
<div align="center">
  <sup>Pipeline of Applied Methods 
</sup>
</div>
</center>
    
    
</br>

> ### Methods Summary


- Data Cleaning: Relabeling ì§„í–‰í•¨
- Reclassified dataset: General Trash ë‚´ì˜ ê°ì²´ë“¤ì„ íŠ¹ì§•ì— ë”°ë¼ ìƒˆë¡œìš´ í´ë˜ìŠ¤ë¡œ ì¬ë¶„ë¥˜í•¨
- Deblur: íë¦° ì´ë¯¸ì§€ ë¶„ë¥˜ ë° ë³´ì • ê¸°ë²•
- Super Resolution: Super Resolution ê¸°ë²•ì„ ì ìš©í•˜ì—¬ ì´ë¯¸ì§€ í•´ìƒë„ë¥¼ ë†’ì„
- Augmentation: ë‹¤ì–‘í•œ ì¦ê°• ê¸°ë²•ì„ ì ìš©í•˜ì—¬ ì¢‹ì€ ì„±ëŠ¥ì„ ë‚´ëŠ” ê¸°ë²•ì„ ì°¾ì•„ ì ìš©í•¨

</br>


## ğŸ”¬ Methods

<!-- ì „ì²´ íŒŒì´í”„ë¼ì¸ ì´ë¯¸ì§€ ë° methods ì„¤ëª… -->
> ### Data Cleaning
- ë°ì´í„° ì‹œê°í™”ë¥¼ í†µí•´ ë‹¤ìˆ˜ì˜ ë ˆì´ë¸” ì˜¤ë¥˜ê°€ ë°œê²¬ë˜ì–´ Superviselyë¥¼ í™œìš©í•´ ë°ì´í„° ë ˆì´ë¸” ìˆ˜ì • í›„ ì‹¤í—˜ ì§„í–‰í•¨

<!-- ì‹¤í—˜ ê²°ê³¼ í‘œ -->
| Dataset | Model | Backbone | mAP_50(Val) | mAP_50(Test) |
|:-----------:|:---------:|:------------:|:---------:|:---------------------------:|
|   Original  |    Dino   |    Swin-l    |   0.716   |            0.6938           |
|  Relabeled  |    Dino   |    Swin-l    |   0.582   |            0.6488           |

</br>


> ### Reclassify General Trash Class



<center>
<img src="https://github.com/Eddie-JUB/Portfolio/assets/71426994/c979c02f-804f-4976-9e5e-2bc49612ad28" width="700" height="">
<div align="center">
  <sup>Annotation per class in Class-20 Train Dataset
</sup>
</div>
</center>

</br>



- ë‹¤ì–‘í•œ íŠ¹ì„±ì„ ì§€ë‹Œ ê°ì²´ë“¤ë¡œ êµ¬ì„±ëœ General Trash í´ë˜ìŠ¤ë¥¼ 10ê°œì˜ í´ë˜ìŠ¤ë¡œ ì¬ë¶„ë¥˜í•˜ì—¬ ì´20ê°œì˜ í´ë˜ìŠ¤ë¡œ ì´ë£¨ì–´ì§„ Class-20 ë°ì´í„°ì…‹ìœ¼ë¡œ ì¬êµ¬ì„±í•¨
- Class-20ì˜ General trash í´ë˜ìŠ¤ ì¤‘ ë†’ì€ mAPë¥¼ ë³´ì¸ 3ê°œì˜ í´ë˜ìŠ¤ë¥¼ ì„ ì •í•´ 12ê°œì˜ í´ë˜ìŠ¤ë¡œ ì´ë£¨ì–´ì§„ Class-12, 13ê°œì˜ í´ë˜ìŠ¤ë¡œ ì´ë£¨ì–´ì§„ Class-13 ë°ì´í„°ì…‹ìœ¼ë¡œ ì¬êµ¬ì„±í•¨
<!-- ì‹¤í—˜ ê²°ê³¼ í‘œ -->
    
| **Dataset** | **Model** | **Backbone** | **Epochs** | **mAP_50(Test)** |
|:-----------:|:---------:|:------------:|:----------:|:---------------------------:|
|   Original  |    Dino   |    Swin-l    |     23     |            0.717            |
|   Class-20  |    Dino   |    Swin-l    |     23     |            0.679            |
|   Class-12  |    Dino   |    Swin-l    |     23     |            0.673            |
|   Class-13  |    Dino   |    Swin-l    |     23     |            0.711            |





    
</br>

> ### Deblur
- Train ë° Test datasetì— blur image ë‹¤ìˆ˜ ë°œê²¬í•¨
- ì´ë¥¼ ë¶„ë¥˜ í•œ ê²°ê³¼ Train 21.89% Test 22.02% blurred image ì¡´ì¬í•¨
- ì´ë“¤ì„ deblurrë¥¼ í†µí•´ ë³´ì • í›„ í•™ìŠµì— ì‚¬ìš©í•˜ì˜€ìœ¼ë‚˜ ìœ ì˜ë¯¸í•œ ì„±ëŠ¥ í–¥ìƒ ì—†ìŒ
<center>
<img src="https://github.com/Eddie-JUB/Portfolio/assets/71426994/8d534a92-b445-49ba-bee9-f34d2bc86337" width="400" height="">
</center>

</br>

| Dataset | Model | Backbone | mAP_50(Val) |
|:-----------:|:---------:|:--------------------:|:------------------:|
|   Original  |    Dino   |    Swin-l    |   0.716   |
|  Deblurred  |    Dino   |    Swin-l    |   0.704   |

</br>


> ### Super Resolution
 - Enhanced Deep Residual Networks for Single Image Super-Resolutionì— ì œì•ˆëœ SR ê¸°ë²•ì„ ì ìš©í•˜ì—¬ 2ë°° í•´ìƒë„ì˜ ì´ë¯¸ì§€ë¡œ ë³€í™˜í•¨
 - í•´ë‹¹ ì´ë¯¸ì§€ë¥¼ Center-crop ë˜ëŠ” Multi-crop ìˆ˜í–‰í•œ ë’¤ ì´ë¥¼ ê¸°ì¡´ ë°ì´í„°ì…‹ê³¼ í•©ê»˜ í•™ìŠµ ë°ì´í„°ë¡œ í™œìš©í•¨

<center>
<img src="https://github.com/Eddie-JUB/Portfolio/assets/71426994/d099961e-b432-46ee-bef0-149a56f405b0" width="400" height="">
<div align="center">
  <sup>Center-Crop</sup>
</div>
</center>


<center>
<img src="https://github.com/Eddie-JUB/Portfolio/assets/71426994/f784dacf-c973-498e-a652-5d16bb4de0bd" width="400" height="">
<div align="center">
    <sup>Multi-Crop</sup>
</div>
</center>


<!-- <center>  -->

| Dataset            | Model | Backbone | Epoch | mAP_50(Val) |
|:-------:|:----------:|:-----------------------:|:-------:|:---------:|
| Original           | DINO  | Swin-l   | 20    | 0.731   |
| Original+SR(Center-Crop)      | DINO  | Swin-l   | 25    | 0.802   |
| Original+SR(Multi-Crop) | DINO  | Swin-l   | 25    | 0.817   |

<!-- </center> -->
    

</br>

> ### Augmentation
- ë‹¤ì–‘í•œ ì¦ê°• ê¸°ë²•ì„ ì ìš©í•œ ë’¤, ì—¬ëŸ¬ í‰ê°€ ì§€í‘œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì¦ê°• ê¸°ë²•ì„ ì„ ì •í•¨

| **Augmentation**      | **Info**                 | **mAP_50(Val)** |
|:-----------------------:|:--------------------------:|:-----------:|
| None                  | -                        | 0.554     |
| RandomCrop            | RandomCrop               | 0.565     |
| RandomCenterCropPad   | CenterCrop + pad         | 0.568     |
| RandomAffine          | Geometric transformation | 0.561     |
| PhotoMetricDistortion | Color Jitter             | 0.564     |
| RandAugment           | Color transformation     | 0.571     |

- ê¸°í•˜í•™ì  ë³€í™˜ì„ ì ìš©í•  ê²½ìš° IoU ì„ê³„ê°’ì— ë”°ë¼ mAPê°€ í¬ê²Œ ë‹¬ë¼ì§€ëŠ” ê²½í–¥ì„ ë³´ì—¬ì¤Œ
- ìƒ‰ìƒ ë³€í™˜ì— ëŒ€í•œ RandAugment ê¸°ë²•ì„ ì ìš©í•œ ê²°ê³¼ ê°•ê±´í•˜ê³  ë†’ì€ ì„±ëŠ¥ í–¥ìƒì„ ë³´ì—¬ì¤Œ
</br>


> ### Models
- ë‹¤ì–‘í•œ ëª¨ë¸ì„ í™œìš©í•˜ê¸° ìœ„í•´ ì—¬ëŸ¬ í”„ë ˆì„ì›Œí¬ë¥¼ í™œìš©í•´ì„œ ëª¨ë¸ì„ í‰ê°€í•¨
```bash
Frameworks : Detectron2 v0.6, Ultralytics v8.1, mmDetection v3.3.0
```

<center>
<img src="https://github.com/FinalCold/Programmers/assets/67350632/6de0cd46-8ee8-4f85-a9cf-1215d2d453fd" width="700" height="">
<div align="center">
<!--   <sup>Test dataset(Public) -->
</sup>
</div>
</center>





<!-- |    Framework   |     Model    |   Backbone   | Val mAP50 |
|:--------------:|:------------:|:------------:|:---------:|
| Detectron 2    | Faster RCNN  | R50          |   0.450   |
|                | Cascade RCNN |              |   0.452   |
| Yolo v8        | Yolo v8m     | CSPDarknet53 |   0.414   |
|                | Yolo v8x     |              |   0.474   |
| mmDetection v3 | Cascade RCNN | R50          |   0.458   |
|                |              | ConvNext-s   |   0.554   |
|                |              | Swin-t       |   0.512   |
|                | DDQ          | R50          |   0.560   |
|                |              | Swin-l       |   0.677   |
|                | DINO         | R101         |   0.580   |
|                |              | Swin-l       |   0.719   |
|                | Co-Detr      | Swin-l       |   0.717   |
 -->

</br>


> ### Ensemble
- WBF (Weighted Box Fusion) ê¸°ë²• ì ìš© í•˜ì˜€ìœ¼ë‚˜ ìœ ì˜ë¯¸í•œ ì„±ëŠ¥ í–¥ìƒ ì—†ìŒ
- ë‹¨ì¼ ëª¨ë¸ì˜ ì„±ëŠ¥ì´ ì•™ìƒë¸” ê¸°ë²•ë³´ë‹¤ ë†’ìŒ

| Models                   | Average mAP_50(Val) | Ensemble mAP_50(Test) |
|:-------------------------------:|:-------------:|:-----------------:|
| YOLO + Cascade (R50 + ConvNeXt) | 0.5123      | 0.6061       |
| DINO + DDQ + Co-detr    | 0.6761      | 0.5911       |


</br>

# ğŸ“ˆ Experimental Result

<!-- > ### mAP_50 Test Score Trend Graph -->

<center>
<img src="https://github.com/FinalCold/Programmers/assets/67350632/4f5bce3d-b041-4b64-92ef-d3fa3f56fbb6" width="700" height="">
<div align="center">
    <sup> mAP_50 Test dataset(Public) </sup>
</div>
</center>
